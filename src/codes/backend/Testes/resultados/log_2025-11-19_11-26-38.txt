
--- ğŸš€ [GLOBAL SETUP] Iniciando ambiente de teste ---
Verificando permissÃµes de sistema...
PermissÃµes nÃ£o encontradas. Criando permissÃµes padrÃ£o...
PermissÃµes padrÃ£o criadas com sucesso!
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ (index) â”‚ Nome            â”‚ DescriÃ§Ã£o                                                                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0       â”‚ 'ROOT'          â”‚ 'SuperusuÃ¡rio. Acesso irrestrito a todos os dados e configuraÃ§Ãµes do sistema.'                   â”‚
â”‚ 1       â”‚ 'ADMIN_COMPANY' â”‚ 'Administrador de uma empresa. Pode gerenciar usuÃ¡rios e todos os dados da sua prÃ³pria empresa.' â”‚
â”‚ 2       â”‚ 'USER_COMPANY'  â”‚ 'UsuÃ¡rio padrÃ£o. Pode criar e gerenciar seus prÃ³prios dados dentro da empresa.'                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â³ Iniciando servidor Smart GestÃ£o (startServer)...
ConexÃ£o com o MongoDB estabelecida com sucesso.
âœ… [1/1] ConexÃ£o com o banco de dados estabelecida!
âœ… Servidor rodando na porta 5000
--- âœ… [GLOBAL SETUP] Ambiente pronto e servidor iniciado ---
(node:20568) ExperimentalWarning: VM Modules is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
[LOG] AÃ§Ã£o: CREATE_GOAL | UsuÃ¡rio: 691dd3a3647e9a40e7e5c8f6
[0mPOST /api/goals [32m201[0m 52.878 ms - 455[0m
[LOG] AÃ§Ã£o: CREATE_GOAL | UsuÃ¡rio: 691dd3a3647e9a40e7e5c8f6
[LOG] AÃ§Ã£o: CREATE_TRANSACTION | UsuÃ¡rio: 691dd3a3647e9a40e7e5c8f6
[DEBUG] checkGoalOnTransactionCreate chamado. ID: 691dd3a4647e9a40e7e5c910, Type: expense
[DEBUG] Buscando meta. CompanyId: 691dd3a3647e9a40e7e5c8f4 (object), Category: AlimentaÃ§Ã£o, Date: Wed Nov 19 2025 11:26:44 GMT-0300 (Brasilia Standard Time)
[DEBUG] Metas encontradas no banco para esta empresa: 1
   - Goal ID: 691dd3a4647e9a40e7e5c904
     Category: AlimentaÃ§Ã£o (Match? true)
     Type: expense (Match? true)
     Start: Sat Nov 01 2025 00:00:00 GMT-0300 (Brasilia Standard Time) (Match? true)
     End: Sun Nov 30 2025 00:00:00 GMT-0300 (Brasilia Standard Time) (Match? true)
[DEBUG] Verificando meta para transaÃ§Ã£o: 691dd3a4647e9a40e7e5c910, Valor: 80, Categoria: AlimentaÃ§Ã£o
[DEBUG] Meta encontrada: 691dd3a4647e9a40e7e5c904, Alvo: 100
[DEBUG] Total Anterior: 0, Novo Total: 80, Meta: 100
[0mPOST /api/transactions [32m201[0m 91.157 ms - 448[0m
[LOG] AÃ§Ã£o: CREATE_TRANSACTION | UsuÃ¡rio: 691dd3a3647e9a40e7e5c8f6
[0mGET /api/alerts [32m200[0m 27.984 ms - 72[0m
[LOG] AÃ§Ã£o: CREATE_TRANSACTION | UsuÃ¡rio: 691dd3a3647e9a40e7e5c8f6
[DEBUG] checkGoalOnTransactionCreate chamado. ID: 691dd3a4647e9a40e7e5c91c, Type: expense
[DEBUG] Buscando meta. CompanyId: 691dd3a3647e9a40e7e5c8f4 (object), Category: AlimentaÃ§Ã£o, Date: Wed Nov 19 2025 11:26:44 GMT-0300 (Brasilia Standard Time)
[DEBUG] Metas encontradas no banco para esta empresa: 1
   - Goal ID: 691dd3a4647e9a40e7e5c904
     Category: AlimentaÃ§Ã£o (Match? true)
     Type: expense (Match? true)
     Start: Sat Nov 01 2025 00:00:00 GMT-0300 (Brasilia Standard Time) (Match? true)
     End: Sun Nov 30 2025 00:00:00 GMT-0300 (Brasilia Standard Time) (Match? true)
[DEBUG] Verificando meta para transaÃ§Ã£o: 691dd3a4647e9a40e7e5c91c, Valor: 30, Categoria: AlimentaÃ§Ã£o
[DEBUG] Meta encontrada: 691dd3a4647e9a40e7e5c904, Alvo: 100
[DEBUG] Total Anterior: 80, Novo Total: 110, Meta: 100
[LOG] AÃ§Ã£o: AUTO_CREATE_ALERT | UsuÃ¡rio: 691dd3a3647e9a40e7e5c8f6
[0mPOST /api/transactions [32m201[0m 137.431 ms - 445[0m
[LOG] AÃ§Ã£o: CREATE_TRANSACTION | UsuÃ¡rio: 691dd3a3647e9a40e7e5c8f6
[0mGET /api/alerts [32m200[0m 26.932 ms - 419[0m
[LOG] AÃ§Ã£o: CREATE_TRANSACTION | UsuÃ¡rio: 691dd3a3647e9a40e7e5c8f6
[DEBUG] checkGoalOnTransactionCreate chamado. ID: 691dd3a4647e9a40e7e5c92d, Type: expense
[DEBUG] Buscando meta. CompanyId: 691dd3a3647e9a40e7e5c8f4 (object), Category: AlimentaÃ§Ã£o, Date: Wed Nov 19 2025 11:26:44 GMT-0300 (Brasilia Standard Time)
[DEBUG] Metas encontradas no banco para esta empresa: 1
   - Goal ID: 691dd3a4647e9a40e7e5c904
     Category: AlimentaÃ§Ã£o (Match? true)
     Type: expense (Match? true)
     Start: Sat Nov 01 2025 00:00:00 GMT-0300 (Brasilia Standard Time) (Match? true)
     End: Sun Nov 30 2025 00:00:00 GMT-0300 (Brasilia Standard Time) (Match? true)
[DEBUG] Verificando meta para transaÃ§Ã£o: 691dd3a4647e9a40e7e5c92d, Valor: 50, Categoria: AlimentaÃ§Ã£o
[DEBUG] Meta encontrada: 691dd3a4647e9a40e7e5c904, Alvo: 100
[DEBUG] Total Anterior: 110, Novo Total: 160, Meta: 100
[0mPOST /api/transactions [32m201[0m 85.155 ms - 437[0m
[LOG] AÃ§Ã£o: CREATE_TRANSACTION | UsuÃ¡rio: 691dd3a3647e9a40e7e5c8f6
[0mGET /api/alerts [32m200[0m 27.628 ms - 419[0m
PASS Testes/2-features/alerts.test.js
  6. MÃ³dulo de Alertas de Metas
    âˆš RF-006: deve criar um alerta quando uma despesa ultrapassa a meta da categoria (506 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        0.854 s
Ran all test suites matching Testes/2-features/alerts.test.js.

--- ğŸ§¹ [GLOBAL TEARDOWN] Finalizando ambiente de teste ---
   - [OK] Dados de teste temporÃ¡rios foram removidos.
âœ… Servidor e conexÃ£o com MongoDB encerrados (stopServer).
--- âœ… [GLOBAL TEARDOWN] Ambiente finalizado com sucesso ---
