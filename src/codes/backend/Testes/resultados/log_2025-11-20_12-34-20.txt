
--- üöÄ [GLOBAL SETUP] Iniciando ambiente de teste ---
‚è≥ Iniciando servidor Smart Gest√£o (startServer)...
Conex√£o com o MongoDB estabelecida com sucesso.
‚úÖ [1/1] Conex√£o com o banco de dados estabelecida!
‚ö†Ô∏è  Aviso: Porta 5000 est√° em uso. Tentando porta 5001...
‚úÖ Servidor rodando na porta 5001
Verificando permiss√µes de sistema...
Permiss√µes de sistema j√° existem. Nenhuma a√ß√£o necess√°ria.
--- ‚úÖ [GLOBAL SETUP] Ambiente pronto e servidor iniciado ---
(node:32644) ExperimentalWarning: VM Modules is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
POST /api/auth/login 200 688 - 108.893 ms
[LOG] A√ß√£o: LOGIN_USER | Usu√°rio: N/A
POST /api/auth/login 200 688 - 97.030 ms
[LOG] A√ß√£o: LOGIN_USER | Usu√°rio: N/A
POST /api/auth/logout 200 108 - 21.531 ms
PASS Testes/1-auth/auth.test.js
  6. M√≥dulo de Autentica√ß√£o e Sess√£o (Stateful)
    ‚àö deve criar um SessionToken no banco de dados ap√≥s o login (148 ms)
    ‚àö deve invalidar o SessionToken no banco de dados ap√≥s o logout (128 ms)

  console.log
    
    --- Teste: Solicitar reset para e-mail inv√°lido ---

      at Object.<anonymous> (Testes/1-auth/password.test.js:33:13)

[LOG] A√ß√£o: LOGOUT_USER | Usu√°rio: N/A
POST /api/auth/forgot-password 404 69 - 14.893 ms
  console.log
    ‚úÖ Falhou como esperado para e-mail inexistente (Status 404).

      at Object.<anonymous> (Testes/1-auth/password.test.js:42:15)

  console.log
    
    --- Teste: Gerar token de reset com sucesso ---

      at Object.<anonymous> (Testes/1-auth/password.test.js:51:13)

POST /api/auth/forgot-password 200 164 - 33.818 ms
  console.log
    ‚úÖ Token de reset gerado e salvo no banco de dados.

      at Object.<anonymous> (Testes/1-auth/password.test.js:61:13)

  console.log
    
    --- Teste: Resetar senha com token v√°lido ---

      at Object.<anonymous> (Testes/1-auth/password.test.js:70:13)

POST /api/auth/forgot-password 200 164 - 30.119 ms
POST /api/auth/reset-password/6d77441fa86f4d15edbf197701394b951d8cf2acccc536fd47608df924aca839 200 68 - 98.821 ms
  console.log
    ‚úÖ Senha resetada com sucesso via API.

      at Object.<anonymous> (Testes/1-auth/password.test.js:87:13)

POST /api/auth/reset-password/6d77441fa86f4d15edbf197701394b951d8cf2acccc536fd47608df924aca839 400 72 - 14.509 ms
  console.log
    ‚úÖ Token de reset foi invalidado no banco.

      at Object.<anonymous> (Testes/1-auth/password.test.js:91:13)

POST /api/auth/login 200 688 - 106.522 ms
  console.log
    ‚úÖ Login com a nova senha realizado com sucesso.

      at Object.<anonymous> (Testes/1-auth/password.test.js:101:13)

PASS Testes/1-auth/password.test.js
  9. M√≥dulo de Recupera√ß√£o de Senha
    ‚àö deve falhar ao solicitar reset para um e-mail inexistente (46 ms)
    ‚àö deve gerar e salvar um token de reset para um e-mail v√°lido (39 ms)
    ‚àö deve resetar a senha com um token v√°lido e permitir login com a nova senha (266 ms)

[LOG] A√ß√£o: LOGIN_USER | Usu√°rio: N/A
[LOG] A√ß√£o: CREATE_GOAL | Usu√°rio: 691f35027193b36a4007fd66
POST /api/goals 201 455 - 54.505 ms
[LOG] A√ß√£o: CREATE_GOAL | Usu√°rio: 691f35027193b36a4007fd66
[LOG] A√ß√£o: CREATE_TRANSACTION | Usu√°rio: 691f35027193b36a4007fd66
POST /api/transactions 201 448 - 78.082 ms
[LOG] A√ß√£o: CREATE_TRANSACTION | Usu√°rio: 691f35027193b36a4007fd66
GET /api/alerts 200 72 - 28.082 ms
[LOG] A√ß√£o: CREATE_TRANSACTION | Usu√°rio: 691f35027193b36a4007fd66
[LOG] A√ß√£o: AUTO_CREATE_ALERT | Usu√°rio: 691f35027193b36a4007fd66
POST /api/transactions 201 445 - 112.985 ms
[LOG] A√ß√£o: CREATE_TRANSACTION | Usu√°rio: 691f35027193b36a4007fd66
GET /api/alerts 200 419 - 28.113 ms
[LOG] A√ß√£o: CREATE_TRANSACTION | Usu√°rio: 691f35027193b36a4007fd66
POST /api/transactions 201 437 - 73.760 ms
[LOG] A√ß√£o: CREATE_TRANSACTION | Usu√°rio: 691f35027193b36a4007fd66
GET /api/alerts 200 419 - 26.635 ms
PASS Testes/2-features/alerts.test.js
  6. M√≥dulo de Alertas de Metas
    ‚àö RF-006: deve criar um alerta quando uma despesa ultrapassa a meta da categoria (436 ms)

POST /api/clients 201 329 - 30.125 ms
[LOG] A√ß√£o: CREATE_CLIENT | Usu√°rio: 691f35027193b36a4007fd66
GET /api/clients 200 579 - 26.978 ms
PUT /api/clients/691f35047193b36a4007fdb7 200 331 - 44.936 ms
[LOG] A√ß√£o: UPDATE_CLIENT | Usu√°rio: 691f35027193b36a4007fd66
DELETE /api/clients/691f35047193b36a4007fdb7 200 70 - 43.230 ms
PASS Testes/2-features/clients.test.js
  7. M√≥dulo de Clientes/Fornecedores
    ‚àö deve CRIAR um novo cliente com sucesso (41 ms)
    ‚àö deve LISTAR os clientes da empresa (29 ms)
    ‚àö deve ATUALIZAR um cliente existente (48 ms)
    ‚àö deve EXCLUIR um cliente existente (47 ms)

[LOG] A√ß√£o: DELETE_CLIENT | Usu√°rio: 691f35027193b36a4007fd66
[LOG] A√ß√£o: CREATE_GOAL | Usu√°rio: 691f35027193b36a4007fd66
POST /api/goals 201 404 - 48.892 ms
[LOG] A√ß√£o: CREATE_GOAL | Usu√°rio: 691f35027193b36a4007fd66
GET /api/goals 200 792 - 26.804 ms
[LOG] A√ß√£o: UPDATE_GOAL | Usu√°rio: 691f35027193b36a4007fd66
PUT /api/goals/691f35047193b36a4007fdc8 200 414 - 61.051 ms
[LOG] A√ß√£o: UPDATE_GOAL | Usu√°rio: 691f35027193b36a4007fd66
[LOG] A√ß√£o: DELETE_GOAL | Usu√°rio: 691f35027193b36a4007fd66
DELETE /api/goals/691f35047193b36a4007fdc8 200 67 - 59.470 ms
[LOG] A√ß√£o: DELETE_GOAL | Usu√°rio: 691f35027193b36a4007fd66
GET /api/goals/null 404 53 - 14.186 ms
PASS Testes/2-features/goals.test.js
  5. M√≥dulo de Metas (CRUD)
    ‚àö deve CRIAR uma nova meta com sucesso (65 ms)
    ‚àö deve LISTAR as metas do usu√°rio logado (30 ms)
    ‚àö deve ATUALIZAR uma meta existente (65 ms)
    ‚àö deve EXCLUIR uma meta existente (84 ms)

[LOG] A√ß√£o: CREATE_TRANSACTION | Usu√°rio: 691f35027193b36a4007fd66
POST /api/transactions 201 468 - 48.230 ms
[LOG] A√ß√£o: CREATE_TRANSACTION | Usu√°rio: 691f35027193b36a4007fd66
POST /api/transactions 400 277 - 14.807 ms
[LOG] A√ß√£o: CREATE_TRANSACTION | Usu√°rio: 691f35027193b36a4007fd66
GET /api/transactions 200 1930 - 28.109 ms
GET /api/transactions/691f35047193b36a4007fde0 200 452 - 39.632 ms
[LOG] A√ß√£o: UPDATE_TRANSACTION | Usu√°rio: 691f35027193b36a4007fd66
PUT /api/transactions/691f35047193b36a4007fde0 200 452 - 60.587 ms
[LOG] A√ß√£o: UPDATE_TRANSACTION | Usu√°rio: 691f35027193b36a4007fd66
[LOG] A√ß√£o: DELETE_TRANSACTION | Usu√°rio: 691f35027193b36a4007fd66
DELETE /api/transactions/691f35047193b36a4007fde0 200 73 - 61.725 ms
[LOG] A√ß√£o: DELETE_TRANSACTION | Usu√°rio: 691f35027193b36a4007fd66
GET /api/transactions/691f35047193b36a4007fde0 404 71 - 39.992 ms
PASS Testes/2-features/transactions.test.js
  4. M√≥dulo de Transa√ß√µes (CRUD)
    ‚àö deve CRIAR uma nova transa√ß√£o com sucesso (62 ms)
    ‚àö deve falhar ao tentar criar uma transa√ß√£o com dados inv√°lidos (22 ms)
    ‚àö deve LISTAR as transa√ß√µes do usu√°rio logado (32 ms)
    ‚àö deve OBTER uma transa√ß√£o espec√≠fica pelo ID (42 ms)
    ‚àö deve ATUALIZAR uma transa√ß√£o existente (63 ms)
    ‚àö deve EXCLUIR uma transa√ß√£o existente (107 ms)

[LOG] A√ß√£o: CREATE_TRANSACTION | Usu√°rio: 691f35027193b36a4007fd66
POST /api/transactions 201 446 - 46.459 ms
[LOG] A√ß√£o: CREATE_TRANSACTION | Usu√°rio: 691f35027193b36a4007fd66
[LOG] A√ß√£o: DELETE_TRANSACTION | Usu√°rio: 691f35027193b36a4007fd66
DELETE /api/transactions/691f35057193b36a4007fe01 200 73 - 61.096 ms
[LOG] A√ß√£o: DELETE_TRANSACTION | Usu√°rio: 691f35027193b36a4007fd66
[LOG] A√ß√£o: CREATE_TRANSACTION | Usu√°rio: 691f35027193b36a4007fd66
POST /api/transactions 201 444 - 62.207 ms
[LOG] A√ß√£o: CREATE_TRANSACTION | Usu√°rio: 691f35027193b36a4007fd66
[LOG] A√ß√£o: DELETE_TRANSACTION | Usu√°rio: 691f35027193b36a4007fd66
DELETE /api/transactions/691f35057193b36a4007fe0f 200 73 - 59.804 ms
[LOG] A√ß√£o: DELETE_TRANSACTION | Usu√°rio: 691f35027193b36a4007fd66
[LOG] A√ß√£o: CREATE_TRANSACTION | Usu√°rio: 691f35027193b36a4007fd66
POST /api/transactions 201 444 - 60.393 ms
[LOG] A√ß√£o: CREATE_TRANSACTION | Usu√°rio: 691f35027193b36a4007fd66
[LOG] A√ß√£o: DELETE_TRANSACTION | Usu√°rio: 691f35027193b36a4007fd66
DELETE /api/transactions/691f35057193b36a4007fe1e 200 73 - 63.365 ms
[LOG] A√ß√£o: DELETE_TRANSACTION | Usu√°rio: 691f35027193b36a4007fd66
[LOG] A√ß√£o: CREATE_TRANSACTION | Usu√°rio: 691f35027193b36a4007fd66
POST /api/transactions 201 445 - 61.987 ms
[LOG] A√ß√£o: CREATE_TRANSACTION | Usu√°rio: 691f35027193b36a4007fd66
[LOG] A√ß√£o: DELETE_TRANSACTION | Usu√°rio: 691f35027193b36a4007fd66
FAIL Testes/2-features/uploads.test.js
  Feature: Uploads
    Upload de PDF
      √ó Deve permitir o upload de um anexo (PDF) para uma transa√ß√£o
      √ó Deve permitir a exclus√£o de um anexo (PDF) de uma transa√ß√£o (1 ms)
    Upload de Imagem (PNG)
      √ó Deve permitir o upload de um anexo de imagem (.png) para uma transa√ß√£o
      √ó Deve permitir a exclus√£o de um anexo de imagem (.png) (1 ms)
    Upload de Imagem (JPG)
      √ó Deve permitir o upload de um anexo de imagem (.jpg) para uma transa√ß√£o
      √ó Deve permitir a exclus√£o de um anexo de imagem (.jpg) (1 ms)
    Upload de Imagem (JPEG)
      √ó Deve permitir o upload de um anexo de imagem (.jpeg) para uma transa√ß√£o (1 ms)
      √ó Deve permitir a exclus√£o de um anexo de imagem (.jpeg) (1 ms)
    Cen√°rios de Erro e Estruturais
      √ó Deve retornar 404 ao tentar fazer upload para uma transa√ß√£o inexistente (1 ms)

  ‚óè Feature: Uploads ‚Ä∫ Upload de PDF ‚Ä∫ Deve permitir o upload de um anexo (PDF) para uma transa√ß√£o

    ReferenceError: __dirname is not defined

      33 |  */
      34 | const ensureTestFileExists = (fileName) => {
    > 35 |     const dir = path.join(__dirname, '../TesteUpload');
         |                           ^
      36 |     if (!fs.existsSync(dir)) fs.mkdirSync(dir, { recursive: true });
      37 |     const filePath = path.join(dir, fileName);
      38 |     if (!fs.existsSync(filePath)) fs.writeFileSync(filePath, `fake data for ${fileName}`);

      at ensureTestFileExists (Testes/2-features/uploads.test.js:35:27)
      at Object.<anonymous> (Testes/2-features/uploads.test.js:73:30)

  ‚óè Feature: Uploads ‚Ä∫ Upload de PDF ‚Ä∫ Deve permitir a exclus√£o de um anexo (PDF) de uma transa√ß√£o

    expect(received).toBeDefined()

    Received: undefined

      92 |
      93 |         it('Deve permitir a exclus√£o de um anexo (PDF) de uma transa√ß√£o', async () => {
    > 94 |             expect(attachmentPath).toBeDefined();
         |                                    ^
      95 |
      96 |             const response = await axios.delete(
      97 |                 `${apiUrl}/transactions/${transactionId}/upload`,

      at Object.<anonymous> (Testes/2-features/uploads.test.js:94:36)

  ‚óè Feature: Uploads ‚Ä∫ Upload de Imagem (PNG) ‚Ä∫ Deve permitir o upload de um anexo de imagem (.png) para uma transa√ß√£o

    ReferenceError: __dirname is not defined

      33 |  */
      34 | const ensureTestFileExists = (fileName) => {
    > 35 |     const dir = path.join(__dirname, '../TesteUpload');
         |                           ^
      36 |     if (!fs.existsSync(dir)) fs.mkdirSync(dir, { recursive: true });
      37 |     const filePath = path.join(dir, fileName);
      38 |     if (!fs.existsSync(filePath)) fs.writeFileSync(filePath, `fake data for ${fileName}`);

      at ensureTestFileExists (Testes/2-features/uploads.test.js:35:27)
      at Object.<anonymous> (Testes/2-features/uploads.test.js:147:30)

  ‚óè Feature: Uploads ‚Ä∫ Upload de Imagem (PNG) ‚Ä∫ Deve permitir a exclus√£o de um anexo de imagem (.png)

    expect(received).toBeDefined()

    Received: undefined

      166 |
      167 |         it(`Deve permitir a exclus√£o de um anexo de imagem (.${extension})`, async () => {
    > 168 |             expect(attachmentPath).toBeDefined();
          |                                    ^
      169 |             const response = await axios.delete(
      170 |                 `${apiUrl}/transactions/${transactionId}/upload`,
      171 |                 { headers: { Authorization: `Bearer ${companyA.token}` } }

      at Object.<anonymous> (Testes/2-features/uploads.test.js:168:36)

  ‚óè Feature: Uploads ‚Ä∫ Upload de Imagem (JPG) ‚Ä∫ Deve permitir o upload de um anexo de imagem (.jpg) para uma transa√ß√£o

    ReferenceError: __dirname is not defined

      33 |  */
      34 | const ensureTestFileExists = (fileName) => {
    > 35 |     const dir = path.join(__dirname, '../TesteUpload');
         |                           ^
      36 |     if (!fs.existsSync(dir)) fs.mkdirSync(dir, { recursive: true });
      37 |     const filePath = path.join(dir, fileName);
      38 |     if (!fs.existsSync(filePath)) fs.writeFileSync(filePath, `fake data for ${fileName}`);

      at ensureTestFileExists (Testes/2-features/uploads.test.js:35:27)
      at Object.<anonymous> (Testes/2-features/uploads.test.js:147:30)

  ‚óè Feature: Uploads ‚Ä∫ Upload de Imagem (JPG) ‚Ä∫ Deve permitir a exclus√£o de um anexo de imagem (.jpg)

    expect(received).toBeDefined()

    Received: undefined

      166 |
      167 |         it(`Deve permitir a exclus√£o de um anexo de imagem (.${extension})`, async () => {
    > 168 |             expect(attachmentPath).toBeDefined();
          |                                    ^
      169 |             const response = await axios.delete(
      170 |                 `${apiUrl}/transactions/${transactionId}/upload`,
      171 |                 { headers: { Authorization: `Bearer ${companyA.token}` } }

      at Object.<anonymous> (Testes/2-features/uploads.test.js:168:36)

  ‚óè Feature: Uploads ‚Ä∫ Upload de Imagem (JPEG) ‚Ä∫ Deve permitir o upload de um anexo de imagem (.jpeg) para uma transa√ß√£o

    ReferenceError: __dirname is not defined

      33 |  */
      34 | const ensureTestFileExists = (fileName) => {
    > 35 |     const dir = path.join(__dirname, '../TesteUpload');
         |                           ^
      36 |     if (!fs.existsSync(dir)) fs.mkdirSync(dir, { recursive: true });
      37 |     const filePath = path.join(dir, fileName);
      38 |     if (!fs.existsSync(filePath)) fs.writeFileSync(filePath, `fake data for ${fileName}`);

      at ensureTestFileExists (Testes/2-features/uploads.test.js:35:27)
      at Object.<anonymous> (Testes/2-features/uploads.test.js:147:30)

  ‚óè Feature: Uploads ‚Ä∫ Upload de Imagem (JPEG) ‚Ä∫ Deve permitir a exclus√£o de um anexo de imagem (.jpeg)

    expect(received).toBeDefined()

    Received: undefined

      166 |
      167 |         it(`Deve permitir a exclus√£o de um anexo de imagem (.${extension})`, async () => {
    > 168 |             expect(attachmentPath).toBeDefined();
          |                                    ^
      169 |             const response = await axios.delete(
      170 |                 `${apiUrl}/transactions/${transactionId}/upload`,
      171 |                 { headers: { Authorization: `Bearer ${companyA.token}` } }

      at Object.<anonymous> (Testes/2-features/uploads.test.js:168:36)

  ‚óè Feature: Uploads ‚Ä∫ Cen√°rios de Erro e Estruturais ‚Ä∫ Deve retornar 404 ao tentar fazer upload para uma transa√ß√£o inexistente

    ReferenceError: __dirname is not defined

      33 |  */
      34 | const ensureTestFileExists = (fileName) => {
    > 35 |     const dir = path.join(__dirname, '../TesteUpload');
         |                           ^
      36 |     if (!fs.existsSync(dir)) fs.mkdirSync(dir, { recursive: true });
      37 |     const filePath = path.join(dir, fileName);
      38 |     if (!fs.existsSync(filePath)) fs.writeFileSync(filePath, `fake data for ${fileName}`);

      at ensureTestFileExists (Testes/2-features/uploads.test.js:35:27)
      at Object.<anonymous> (Testes/2-features/uploads.test.js:184:30)

DELETE /api/transactions/691f35057193b36a4007fe2d 200 73 - 65.612 ms
  console.log
    
    --- Configurando 3 empresas para o teste multi-tenant ---

      at Object.<anonymous> (Testes/3-security/multi-tenant.test.js:36:17)

[LOG] A√ß√£o: DELETE_TRANSACTION | Usu√°rio: 691f35027193b36a4007fd66
POST /api/auth/register 201 356 - 137.876 ms
[LOG] A√ß√£o: REGISTER_COMPANY_USER | Usu√°rio: N/A
POST /api/auth/login 200 699 - 96.557 ms
  console.log
    ‚úÖ Empresa 1 (Empresa Teste 17636528701641) cadastrada e logada.

      at Object.<anonymous> (Testes/3-security/multi-tenant.test.js:65:21)

[LOG] A√ß√£o: LOGIN_USER | Usu√°rio: N/A
POST /api/auth/register 201 356 - 145.329 ms
[LOG] A√ß√£o: REGISTER_COMPANY_USER | Usu√°rio: N/A
POST /api/auth/login 200 699 - 101.884 ms
  console.log
    ‚úÖ Empresa 2 (Empresa Teste 17636528704162) cadastrada e logada.

      at Object.<anonymous> (Testes/3-security/multi-tenant.test.js:65:21)

[LOG] A√ß√£o: LOGIN_USER | Usu√°rio: N/A
POST /api/auth/register 201 356 - 171.274 ms
[LOG] A√ß√£o: REGISTER_COMPANY_USER | Usu√°rio: N/A
POST /api/auth/login 200 699 - 145.870 ms
  console.log
    ‚úÖ Empresa 3 (Empresa Teste 17636528706703) cadastrada e logada.

      at Object.<anonymous> (Testes/3-security/multi-tenant.test.js:65:21)

  console.log
    --- Configura√ß√£o multi-tenant conclu√≠da ---

      at Object.<anonymous> (Testes/3-security/multi-tenant.test.js:67:17)

  console.log
    
    --- Criando transa√ß√µes individuais para cada empresa ---

      at Object.<anonymous> (Testes/3-security/multi-tenant.test.js:72:17)

[LOG] A√ß√£o: LOGIN_USER | Usu√°rio: N/A
[LOG] A√ß√£o: CREATE_TRANSACTION | Usu√°rio: 691f35067193b36a4007fe40
POST /api/transactions 201 437 - 46.401 ms
  console.log
    Transa√ß√£o criada para Empresa Teste 17636528701641. ID: 691f35077193b36a4007fe66

      at Object.<anonymous> (Testes/3-security/multi-tenant.test.js:94:21)

[LOG] A√ß√£o: CREATE_TRANSACTION | Usu√°rio: 691f35067193b36a4007fe40
[LOG] A√ß√£o: CREATE_TRANSACTION | Usu√°rio: 691f35067193b36a4007fe4e
POST /api/transactions 201 436 - 45.831 ms
  console.log
    Transa√ß√£o criada para Empresa Teste 17636528704162. ID: 691f35077193b36a4007fe6d

      at Object.<anonymous> (Testes/3-security/multi-tenant.test.js:94:21)

[LOG] A√ß√£o: CREATE_TRANSACTION | Usu√°rio: 691f35067193b36a4007fe4e
[LOG] A√ß√£o: CREATE_TRANSACTION | Usu√°rio: 691f35067193b36a4007fe5c
POST /api/transactions 201 429 - 46.843 ms
  console.log
    Transa√ß√£o criada para Empresa Teste 17636528706703. ID: 691f35077193b36a4007fe74

      at Object.<anonymous> (Testes/3-security/multi-tenant.test.js:94:21)

  console.log
    
    --- Validando isolamento de dados entre todas as empresas ---

      at Object.<anonymous> (Testes/3-security/multi-tenant.test.js:100:17)

  console.log
    
    Verificando a transa√ß√£o 691f35077193b36a4007fe66 da Empresa Teste 17636528701641

      at Object.<anonymous> (Testes/3-security/multi-tenant.test.js:107:21)

[LOG] A√ß√£o: CREATE_TRANSACTION | Usu√°rio: 691f35067193b36a4007fe5c
GET /api/transactions/691f35077193b36a4007fe66 404 38 - 26.332 ms
  console.log
    - OK: Empresa Teste 17636528704162 foi bloqueada (Status 404).

      at Object.<anonymous> (Testes/3-security/multi-tenant.test.js:125:29)

GET /api/transactions/691f35077193b36a4007fe66 404 38 - 26.674 ms
  console.log
    - OK: Empresa Teste 17636528706703 foi bloqueada (Status 404).

      at Object.<anonymous> (Testes/3-security/multi-tenant.test.js:125:29)

  console.log
    
    Verificando a transa√ß√£o 691f35077193b36a4007fe6d da Empresa Teste 17636528704162

      at Object.<anonymous> (Testes/3-security/multi-tenant.test.js:107:21)

GET /api/transactions/691f35077193b36a4007fe6d 404 38 - 26.048 ms
  console.log
    - OK: Empresa Teste 17636528701641 foi bloqueada (Status 404).

      at Object.<anonymous> (Testes/3-security/multi-tenant.test.js:125:29)

GET /api/transactions/691f35077193b36a4007fe6d 404 38 - 27.122 ms
  console.log
    - OK: Empresa Teste 17636528706703 foi bloqueada (Status 404).

      at Object.<anonymous> (Testes/3-security/multi-tenant.test.js:125:29)

  console.log
    
    Verificando a transa√ß√£o 691f35077193b36a4007fe74 da Empresa Teste 17636528706703

      at Object.<anonymous> (Testes/3-security/multi-tenant.test.js:107:21)

GET /api/transactions/691f35077193b36a4007fe74 404 38 - 26.693 ms
  console.log
    - OK: Empresa Teste 17636528701641 foi bloqueada (Status 404).

      at Object.<anonymous> (Testes/3-security/multi-tenant.test.js:125:29)

GET /api/transactions/691f35077193b36a4007fe74 404 38 - 26.200 ms
  console.log
    - OK: Empresa Teste 17636528704162 foi bloqueada (Status 404).

      at Object.<anonymous> (Testes/3-security/multi-tenant.test.js:125:29)

  console.log
    
    --- Validando listagem de transa√ß√µes ---

      at Object.<anonymous> (Testes/3-security/multi-tenant.test.js:132:17)

GET /api/transactions 200 423 - 26.810 ms
  console.log
    - OK: Empresa Teste 17636528701641 listou apenas sua pr√≥pria transa√ß√£o.

      at Object.<anonymous> (Testes/3-security/multi-tenant.test.js:144:21)

GET /api/transactions 200 422 - 26.684 ms
  console.log
    - OK: Empresa Teste 17636528704162 listou apenas sua pr√≥pria transa√ß√£o.

      at Object.<anonymous> (Testes/3-security/multi-tenant.test.js:144:21)

GET /api/transactions 200 415 - 28.066 ms
  console.log
    - OK: Empresa Teste 17636528706703 listou apenas sua pr√≥pria transa√ß√£o.

      at Object.<anonymous> (Testes/3-security/multi-tenant.test.js:144:21)

  console.log
    
    --- Limpando dados de teste (Teardown) ---

      at Object.<anonymous> (Testes/3-security/multi-tenant.test.js:150:17)

DELETE /api/auth/users/691f35067193b36a4007fe40 200 107 - 86.721 ms
  console.log
    - ‚úÖ Empresa Empresa Teste 17636528701641 e dados associados exclu√≠dos com sucesso.

      at Object.<anonymous> (Testes/3-security/multi-tenant.test.js:157:25)

[LOG] A√ß√£o: DELETE_USER_BY_ID | Usu√°rio: 691f35067193b36a4007fe40
DELETE /api/auth/users/691f35067193b36a4007fe4e 200 107 - 81.762 ms
  console.log
    - ‚úÖ Empresa Empresa Teste 17636528704162 e dados associados exclu√≠dos com sucesso.

      at Object.<anonymous> (Testes/3-security/multi-tenant.test.js:157:25)

[LOG] A√ß√£o: DELETE_USER_BY_ID | Usu√°rio: 691f35067193b36a4007fe4e
DELETE /api/auth/users/691f35067193b36a4007fe5c 200 107 - 174.575 ms
  console.log
    - ‚úÖ Empresa Empresa Teste 17636528706703 e dados associados exclu√≠dos com sucesso.

      at Object.<anonymous> (Testes/3-security/multi-tenant.test.js:157:25)

PASS Testes/3-security/multi-tenant.test.js
  3. Teste de Isolamento de Dados (Multi-Tenant)
    ‚àö deve criar uma transa√ß√£o para cada empresa (157 ms)
    ‚àö deve impedir que uma empresa acesse a transa√ß√£o de outra (181 ms)
    ‚àö deve garantir que cada empresa liste apenas suas pr√≥prias transa√ß√µes (93 ms)

[LOG] A√ß√£o: DELETE_USER_BY_ID | Usu√°rio: 691f35067193b36a4007fe5c
  console.log
    
    --- üõ°Ô∏è  Teste de Persist√™ncia: Verificando dados manuais... ---

      at Object.<anonymous> (Testes/3-security/persistence.test.js:37:13)

  console.log
       - [PASS] Usu√°rio da "Empresa Frontend" permaneceu no banco.

      at Object.<anonymous> (Testes/3-security/persistence.test.js:45:15)

  console.log
       - [PASS] Usu√°rio da "Empresa Backend" permaneceu no banco.

      at Object.<anonymous> (Testes/3-security/persistence.test.js:45:15)

  console.log
       - [PASS] Usu√°rio da "Empresa React" permaneceu no banco.

      at Object.<anonymous> (Testes/3-security/persistence.test.js:45:15)

PASS Testes/3-security/persistence.test.js
  Security: Persist√™ncia de Dados Manuais
    ‚àö deve garantir que os usu√°rios de teste manuais permane√ßam no banco ap√≥s a execu√ß√£o de `npm test` (175 ms)

GET /api/reports/export/transactions-pdf 200 - - 48.331 ms
GET /api/reports/export/clients-pdf 200 - - 44.752 ms
GET /api/reports/export/invoice/691f35027193b36a4007fd6e 200 - - 56.868 ms
PASS Testes/4-reports/reports.test.js
  8. M√≥dulo de Relat√≥rios
    ‚àö deve gerar um PDF v√°lido para o RELAT√ìRIO DE TRANSA√á√ïES (88 ms)
    ‚àö deve gerar um PDF v√°lido para o RELAT√ìRIO DE CLIENTES (61 ms)
    ‚àö deve gerar um PDF v√°lido para a FATURA (71 ms)

Test Suites: 1 failed, 9 passed, 10 total
Tests:       9 failed, 27 passed, 36 total
Snapshots:   0 total
Time:        6.721 s
Ran all test suites.

--- üßπ [GLOBAL TEARDOWN] Finalizando ambiente de teste ---
   - [OK] Dados de teste tempor√°rios foram removidos.
‚úÖ Servidor e conex√£o com MongoDB encerrados (stopServer).
--- ‚úÖ [GLOBAL TEARDOWN] Ambiente finalizado com sucesso ---
Jest did not exit one second after the test run has completed.

'This usually means that there are asynchronous operations that weren't stopped in your tests. Consider running Jest with `--detectOpenHandles` to troubleshoot this issue.
