
--- üöÄ [SETUP] Populando banco de dados de teste em mem√≥ria ---
‚úÖ Empresa Padr√£o 1 criada para os testes.
‚úÖ Empresa Padr√£o 2 criada para os testes.
--- ‚úÖ [SETUP] Dados de teste salvos em test-setup.json ---

--- üöÄ [ENV] Iniciando e conectando ao MongoDB em Mem√≥ria ---

--- üßπ [ENV] Desconectando e parando o MongoDB ---
--- ‚úÖ [ENV] Ambiente de teste finalizado ---

--- üöÄ [ENV] Iniciando e conectando ao MongoDB em Mem√≥ria ---

--- üßπ [ENV] Desconectando e parando o MongoDB ---
--- ‚úÖ [ENV] Ambiente de teste finalizado ---

--- üöÄ [ENV] Iniciando e conectando ao MongoDB em Mem√≥ria ---
  console.log
    
    --- Criando transa√ß√£o para Empresa A ---

      at Object.log (isolamento.test.js:30:17)

  console.log
    
    --- Tentando listar transa√ß√µes com token da Empresa B ---

      at Object.log (isolamento.test.js:107:17)

  console.log
    Enviando: GET para http://localhost:5000/api/transactions com token da Empresa B

      at Object.log (isolamento.test.js:108:17)


--- üßπ [ENV] Desconectando e parando o MongoDB ---
--- ‚úÖ [ENV] Ambiente de teste finalizado ---

--- üöÄ [ENV] Iniciando e conectando ao MongoDB em Mem√≥ria ---

--- üßπ [ENV] Desconectando e parando o MongoDB ---
--- ‚úÖ [ENV] Ambiente de teste finalizado ---

--- üöÄ [ENV] Iniciando e conectando ao MongoDB em Mem√≥ria ---

--- üßπ [ENV] Desconectando e parando o MongoDB ---

--- üöÄ [ENV] Iniciando e conectando ao MongoDB em Mem√≥ria ---

--- üßπ [ENV] Desconectando e parando o MongoDB ---
--- ‚úÖ [ENV] Ambiente de teste finalizado ---

--- üöÄ [ENV] Iniciando e conectando ao MongoDB em Mem√≥ria ---
  console.log
    Executando teste para: RF-009 - CRIAR Cliente (Pendente)

      at Object.log (clients.test.js:25:13)

  console.log
    Executando teste para: RF-009 - LISTAR Clientes (Pendente)

      at Object.log (clients.test.js:45:13)


--- üßπ [ENV] Desconectando e parando o MongoDB ---
--- ‚úÖ [ENV] Ambiente de teste finalizado ---

--- üöÄ [ENV] Iniciando e conectando ao MongoDB em Mem√≥ria ---

--- üßπ [ENV] Desconectando e parando o MongoDB ---
--- ‚úÖ [ENV] Ambiente de teste finalizado ---

--- üöÄ [ENV] Iniciando e conectando ao MongoDB em Mem√≥ria ---
  console.log
    
    --- Configurando 3 empresas para o teste multi-tenant ---

      at Object.log (multi-tenant.test.js:12:17)

  console.log
    ‚úÖ Empresa 1 (Empresa Teste 1762815847884) cadastrada e logada.

      at Object.log (multi-tenant.test.js:41:21)

  console.log
    ‚úÖ Empresa 2 (Empresa Teste 1762815848498) cadastrada e logada.

      at Object.log (multi-tenant.test.js:41:21)

  console.log
    ‚úÖ Empresa 3 (Empresa Teste 1762815849136) cadastrada e logada.

      at Object.log (multi-tenant.test.js:41:21)

  console.log
    --- Configura√ß√£o multi-tenant conclu√≠da ---

      at Object.log (multi-tenant.test.js:43:17)

  console.log
    
    --- Criando transa√ß√µes individuais para cada empresa ---

      at Object.log (multi-tenant.test.js:48:17)

  console.log
    Transa√ß√£o criada para Empresa Teste 1762815847884. ID: 69126f690d8254817c70a292

      at Object.log (multi-tenant.test.js:69:21)

  console.log
    Transa√ß√£o criada para Empresa Teste 1762815848498. ID: 69126f690d8254817c70a299

      at Object.log (multi-tenant.test.js:69:21)

  console.log
    Transa√ß√£o criada para Empresa Teste 1762815849136. ID: 69126f690d8254817c70a2a0

      at Object.log (multi-tenant.test.js:69:21)

  console.log
    
    --- Validando isolamento de dados entre todas as empresas ---

      at Object.log (multi-tenant.test.js:75:17)

  console.log
    
    Verificando a transa√ß√£o 69126f690d8254817c70a292 da Empresa Teste 1762815847884

      at Object.log (multi-tenant.test.js:82:21)

  console.log
    - OK: Empresa Teste 1762815848498 foi bloqueada (Status 404).

      at Object.log (multi-tenant.test.js:100:29)

  console.log
    - OK: Empresa Teste 1762815849136 foi bloqueada (Status 404).

      at Object.log (multi-tenant.test.js:100:29)

  console.log
    
    Verificando a transa√ß√£o 69126f690d8254817c70a299 da Empresa Teste 1762815848498

      at Object.log (multi-tenant.test.js:82:21)

  console.log
    - OK: Empresa Teste 1762815847884 foi bloqueada (Status 404).

      at Object.log (multi-tenant.test.js:100:29)

  console.log
    - OK: Empresa Teste 1762815849136 foi bloqueada (Status 404).

      at Object.log (multi-tenant.test.js:100:29)

  console.log
    
    Verificando a transa√ß√£o 69126f690d8254817c70a2a0 da Empresa Teste 1762815849136

      at Object.log (multi-tenant.test.js:82:21)

  console.log
    - OK: Empresa Teste 1762815847884 foi bloqueada (Status 404).

      at Object.log (multi-tenant.test.js:100:29)

  console.log
    - OK: Empresa Teste 1762815848498 foi bloqueada (Status 404).

      at Object.log (multi-tenant.test.js:100:29)

  console.log
    
    --- Validando listagem de transa√ß√µes ---

      at Object.log (multi-tenant.test.js:107:17)

  console.log
    - OK: Empresa Teste 1762815847884 listou apenas sua pr√≥pria transa√ß√£o.

      at Object.log (multi-tenant.test.js:119:21)

  console.log
    - OK: Empresa Teste 1762815848498 listou apenas sua pr√≥pria transa√ß√£o.

      at Object.log (multi-tenant.test.js:119:21)

  console.log
    - OK: Empresa Teste 1762815849136 listou apenas sua pr√≥pria transa√ß√£o.

      at Object.log (multi-tenant.test.js:119:21)

  console.log
    
    --- Limpando dados de teste (Teardown) ---

      at Object.log (multi-tenant.test.js:125:17)

  console.log
    - ‚úÖ Empresa Empresa Teste 1762815847884 exclu√≠da com sucesso.

      at Object.log (multi-tenant.test.js:133:33)

  console.log
    - ‚úÖ Empresa Empresa Teste 1762815848498 exclu√≠da com sucesso.

      at Object.log (multi-tenant.test.js:133:33)

  console.log
    - ‚úÖ Empresa Empresa Teste 1762815849136 exclu√≠da com sucesso.

      at Object.log (multi-tenant.test.js:133:33)


--- üßπ [ENV] Desconectando e parando o MongoDB ---
--- ‚úÖ [ENV] Ambiente de teste finalizado ---

--- üöÄ [ENV] Iniciando e conectando ao MongoDB em Mem√≥ria ---
  console.log
    
    --- Teste: Validar setup do usu√°rio ---

      at Object.log (auth.legacy.test.js:31:17)

  console.log
    ‚úÖ Usu√°rio da Empresa A carregado do setup.

      at Object.log (auth.legacy.test.js:34:17)

  console.log
    
    --- Teste: Login com sucesso ---

      at Object.log (auth.legacy.test.js:77:17)

  console.log
    ‚úÖ Login realizado com sucesso.

      at Object.log (auth.legacy.test.js:86:17)

  console.log
    
    --- Teste: Acesso a rota protegida sem token ---

      at Object.log (auth.legacy.test.js:90:17)

  console.log
    ‚úÖ Acesso sem token foi barrado como esperado (Status 401).

      at Object.log (auth.legacy.test.js:100:21)


--- üßπ [ENV] Desconectando e parando o MongoDB ---
--- ‚úÖ [ENV] Ambiente de teste finalizado ---

--- üöÄ [ENV] Iniciando e conectando ao MongoDB em Mem√≥ria ---
  console.log
    
    --- Teste: Validar setup do usu√°rio ---

      at Object.log (api.test.js:28:17)

  console.log
    ‚úÖ Usu√°rio da Empresa A carregado do setup.

      at Object.log (api.test.js:31:17)

  console.log
    
    --- Teste: Barrar e-mail duplicado ---

      at Object.log (api.test.js:43:17)

  console.log
    ‚úÖ E-mail duplicado barrado com sucesso (Status 409).

      at Object.log (api.test.js:54:21)

  console.log
    
    --- Teste: Login com senha incorreta ---

      at Object.log (api.test.js:63:17)

  console.log
    ‚úÖ Login com senha incorreta falhou como esperado (Status 401).

      at Object.log (api.test.js:72:21)

  console.log
    
    --- Teste: Login com sucesso ---

      at Object.log (api.test.js:81:17)

  console.log
    ‚úÖ Login realizado com sucesso.

      at Object.log (api.test.js:90:17)

  console.log
    
    --- Teste: Acesso a rota protegida sem token ---

      at Object.log (api.test.js:94:17)

  console.log
    ‚úÖ Acesso sem token foi barrado como esperado (Status 401).

      at Object.log (api.test.js:104:21)


--- üßπ [ENV] Desconectando e parando o MongoDB ---
--- ‚úÖ [ENV] Ambiente de teste finalizado ---

--- FIM DOS TESTES AUTOMATIZADOS (COM FALHAS) ---
(node:30360) ExperimentalWarning: VM Modules is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
 FAIL  Testes/auth.test.js (11.609 s)
  6. M√≥dulo de Autentica√ß√£o e Sess√£o (Stateful)
    √ó deve criar um SessionToken no banco de dados ap√≥s o login (10621 ms)
    √ó deve invalidar o SessionToken no banco de dados ap√≥s o logout (127 ms)

  ‚óè 6. M√≥dulo de Autentica√ß√£o e Sess√£o (Stateful) ‚Ä∫ deve criar um SessionToken no banco de dados ap√≥s o login

    MongooseError: Operation `sessiontokens.findOne()` buffering timed out after 10000ms

      at Timeout.<anonymous> (../node_modules/mongoose/lib/drivers/node-mongodb-native/collection.js:185:23)

  ‚óè 6. M√≥dulo de Autentica√ß√£o e Sess√£o (Stateful) ‚Ä∫ deve invalidar o SessionToken no banco de dados ap√≥s o logout

    AxiosError: Request failed with status code 401

      71 |
      72 |     // 2. Realiza o logout enviando o refresh token
    > 73 |     const logoutResponse = await axios.post(`${API_URL}/auth/logout`, { refreshToken });
         |                            ^
      74 |     expect(logoutResponse.status).toBe(200);
      75 |
      76 |     // 3. Verifica no banco se o token foi inativado

      at settle (../node_modules/axios/lib/core/settle.js:19:12)
      at IncomingMessage.handleStreamEnd (../node_modules/axios/lib/adapters/http.js:793:11)
      at Axios.request (../node_modules/axios/lib/core/Axios.js:45:41)
      at Object.<anonymous> (auth.test.js:73:28)

 FAIL  Testes/transactions.test.js
  4. M√≥dulo de Transa√ß√µes (CRUD)
    √ó deve CRIAR uma nova transa√ß√£o com sucesso (36 ms)
    √ó deve falhar ao tentar criar uma transa√ß√£o com dados inv√°lidos (35 ms)
    √ó deve LISTAR as transa√ß√µes do usu√°rio logado
    √ó deve OBTER uma transa√ß√£o espec√≠fica pelo ID (1 ms)
    √ó deve ATUALIZAR uma transa√ß√£o existente
    √ó deve EXCLUIR uma transa√ß√£o existente (1 ms)

  ‚óè 4. M√≥dulo de Transa√ß√µes (CRUD) ‚Ä∫ deve CRIAR uma nova transa√ß√£o com sucesso

    AxiosError: Request failed with status code 401

      44 |         };
      45 |
    > 46 |         const response = await axios.post(`${API_URL}/transactions`, transactionData, {
         |                          ^
      47 |             headers: { Authorization: `Bearer ${userToken}` }
      48 |         });
      49 |

      at settle (../node_modules/axios/lib/core/settle.js:19:12)
      at IncomingMessage.handleStreamEnd (../node_modules/axios/lib/adapters/http.js:793:11)
      at Axios.request (../node_modules/axios/lib/core/Axios.js:45:41)
      at Object.<anonymous> (transactions.test.js:46:26)

  ‚óè 4. M√≥dulo de Transa√ß√µes (CRUD) ‚Ä∫ deve falhar ao tentar criar uma transa√ß√£o com dados inv√°lidos

    expect(received).toBe(expected) // Object.is equality

    Expected: 500
    Received: 401

      75 |             fail('A cria√ß√£o de transa√ß√£o com dados inv√°lidos deveria ter falhado.');
      76 |         } catch (error) {
    > 77 |             expect(error.response.status).toBe(500); // Mongoose validation error results in 500 in this setup
         |                                           ^
      78 |         }
      79 |     });
      80 |

      at Object.toBe (transactions.test.js:77:43)

  ‚óè 4. M√≥dulo de Transa√ß√µes (CRUD) ‚Ä∫ deve LISTAR as transa√ß√µes do usu√°rio logado

    expect(received).toBeDefined()

    Received: undefined

      81 |     it('deve LISTAR as transa√ß√µes do usu√°rio logado', async () => {
      82 |         // Este teste depende que o anterior tenha criado uma transa√ß√£o
    > 83 |         expect(createdTransactionId).toBeDefined();
         |                                      ^
      84 |
      85 |         const response = await axios.get(`${API_URL}/transactions`, {
      86 |             headers: { Authorization: `Bearer ${userToken}` }

      at Object.toBeDefined (transactions.test.js:83:38)

  ‚óè 4. M√≥dulo de Transa√ß√µes (CRUD) ‚Ä∫ deve OBTER uma transa√ß√£o espec√≠fica pelo ID

    expect(received).toBeDefined()

    Received: undefined

       97 |
       98 |     it('deve OBTER uma transa√ß√£o espec√≠fica pelo ID', async () => {
    >  99 |         expect(createdTransactionId).toBeDefined();
          |                                      ^
      100 |
      101 |         const response = await axios.get(`${API_URL}/transactions/${createdTransactionId}`, {
      102 |             headers: { Authorization: `Bearer ${userToken}` }

      at Object.toBeDefined (transactions.test.js:99:38)

  ‚óè 4. M√≥dulo de Transa√ß√µes (CRUD) ‚Ä∫ deve ATUALIZAR uma transa√ß√£o existente

    expect(received).toBeDefined()

    Received: undefined

      109 |
      110 |     it('deve ATUALIZAR uma transa√ß√£o existente', async () => {
    > 111 |         expect(createdTransactionId).toBeDefined();
          |                                      ^
      112 |
      113 |         const updatedData = {
      114 |             description: 'Venda de consultoria (Valor Atualizado)',

      at Object.toBeDefined (transactions.test.js:111:38)

  ‚óè 4. M√≥dulo de Transa√ß√µes (CRUD) ‚Ä∫ deve EXCLUIR uma transa√ß√£o existente

    expect(received).toBeDefined()

    Received: undefined

      127 |
      128 |     it('deve EXCLUIR uma transa√ß√£o existente', async () => {
    > 129 |         expect(createdTransactionId).toBeDefined();
          |                                      ^
      130 |
      131 |         const response = await axios.delete(`${API_URL}/transactions/${createdTransactionId}`, {
      132 |             headers: { Authorization: `Bearer ${userToken}` }

      at Object.toBeDefined (transactions.test.js:129:38)

 FAIL  Testes/isolamento.test.js
  2. Teste de Isolamento de Dados (Transa√ß√µes)
    √ó deve impedir o acesso, modifica√ß√£o e exclus√£o de transa√ß√µes entre empresas (49 ms)
    √ó deve impedir que a Empresa B liste todas as transa√ß√µes da Empresa A (31 ms)

  ‚óè 2. Teste de Isolamento de Dados (Transa√ß√µes) ‚Ä∫ deve impedir o acesso, modifica√ß√£o e exclus√£o de transa√ß√µes entre empresas

    AxiosError: Request failed with status code 401

      30 |         console.log('\n--- Criando transa√ß√£o para Empresa A ---');
      31 |
    > 32 |         const createTransaction = await axios.post(`${API_URL}/transactions`, {
         |                                   ^
      33 |             description: 'Transa√ß√£o de Teste Empresa A',
      34 |             amount: 100,
      35 |             type: 'expense', // Campo obrigat√≥rio, usando o nome padronizado

      at settle (../node_modules/axios/lib/core/settle.js:19:12)
      at IncomingMessage.handleStreamEnd (../node_modules/axios/lib/adapters/http.js:793:11)
      at Axios.request (../node_modules/axios/lib/core/Axios.js:45:41)
      at Object.<anonymous> (isolamento.test.js:32:35)

  ‚óè 2. Teste de Isolamento de Dados (Transa√ß√µes) ‚Ä∫ deve impedir que a Empresa B liste todas as transa√ß√µes da Empresa A

    AxiosError: Request failed with status code 401

      110 |         // A requisi√ß√£o para listar transa√ß√µes da Empresa B precisa do token da Empresa B
      111 |         // para que o backend possa filtrar corretamente.
    > 112 |         const responseB = await axios.get(`${API_URL}/transactions`, { 
          |                           ^
      113 |             headers: { Authorization: `Bearer ${tokenEmpresaB}` }
      114 |         });
      115 |

      at settle (../node_modules/axios/lib/core/settle.js:19:12)
      at IncomingMessage.handleStreamEnd (../node_modules/axios/lib/adapters/http.js:793:11)
      at Axios.request (../node_modules/axios/lib/core/Axios.js:45:41)
      at Object.<anonymous> (isolamento.test.js:112:27)

 FAIL  Testes/isolamento-simples.test.js
  2. Teste de Isolamento de Dados (Simples)
    √ó deve impedir o acesso, modifica√ß√£o e exclus√£o de transa√ß√µes entre empresas (36 ms)
    √ó deve impedir que a Empresa B liste todas as transa√ß√µes da Empresa A (28 ms)

  ‚óè 2. Teste de Isolamento de Dados (Simples) ‚Ä∫ deve impedir o acesso, modifica√ß√£o e exclus√£o de transa√ß√µes entre empresas

    AxiosError: Request failed with status code 401

      38 |     it('deve impedir o acesso, modifica√ß√£o e exclus√£o de transa√ß√µes entre empresas', async () => {
      39 |         // --- 1. Criar uma transa√ß√£o com tokenEmpresaA ---
    > 40 |         const createTransaction = await axios.post(`${API_URL}/transactions`, {
         |                                   ^
      41 |             description: 'Transa√ß√£o de Teste Empresa A',
      42 |             amount: 100,
      43 |             type: 'expense',

      at settle (../node_modules/axios/lib/core/settle.js:19:12)
      at IncomingMessage.handleStreamEnd (../node_modules/axios/lib/adapters/http.js:793:11)
      at Axios.request (../node_modules/axios/lib/core/Axios.js:45:41)
      at Object.<anonymous> (isolamento-simples.test.js:40:35)

  ‚óè 2. Teste de Isolamento de Dados (Simples) ‚Ä∫ deve impedir que a Empresa B liste todas as transa√ß√µes da Empresa A

    AxiosError: Request failed with status code 401

      92 |      */
      93 |     it('deve impedir que a Empresa B liste todas as transa√ß√µes da Empresa A', async () => {
    > 94 |         const responseB = await axios.get(`${API_URL}/transactions`, { 
         |                           ^
      95 |             headers: { Authorization: `Bearer ${tokenEmpresaB}` }
      96 |         });
      97 |

      at settle (../node_modules/axios/lib/core/settle.js:19:12)
      at IncomingMessage.handleStreamEnd (../node_modules/axios/lib/adapters/http.js:793:11)
      at Axios.request (../node_modules/axios/lib/core/Axios.js:45:41)
      at Object.<anonymous> (isolamento-simples.test.js:94:27)

Starting the MongoMemoryServer Instance failed, enable debug log for more information. Error:
 UnexpectedCloseError: Instance closed unexpectedly with code "48" and signal "null"
    at MongoInstance.closeHandler (C:\Users\HERON-ACER\Documents\GitHub\pbr-si-2025-2-p3-tiapn-t1-9147100-smart-gestao\src\codes\backend\node_modules\mongodb-memory-server-core\src\util\MongoInstance.ts:578:52)
    at ChildProcess.emit (node:events:508:28)
    at maybeClose (node:internal/child_process:1101:16)
    at Process.ChildProcess._handle.onexit (node:internal/child_process:305:5)
 FAIL  Testes/isolamento.legacy.test.js
  ‚óè Test suite failed to run

    TypeError: Cannot read properties of undefined (reading 'stop')

      55 |     if (fs.existsSync(uriPath)) {
      56 |       fs.unlinkSync(uriPath);
    > 57 |     }
         |      ^
      58 |     await this.global.__MONGOD__.stop();
      59 |     await super.teardown();
      60 |     console.log('--- ‚úÖ [ENV] Ambiente de teste finalizado ---');

      at MongoTestEnvironment.teardown (../file:/C:/Users/HERON-ACER/Documents/GitHub/pbr-si-2025-2-p3-tiapn-t1-9147100-smart-gestao/src/codes/backend/Testes/mongo-test-environment.js:57:34)

 FAIL  Testes/metas.test.js
  5. M√≥dulo de Metas (CRUD)
    √ó deve CRIAR uma nova meta com sucesso (38 ms)
    √ó deve LISTAR as metas do usu√°rio logado (1 ms)
    √ó deve ATUALIZAR uma meta existente
    √ó deve EXCLUIR uma meta existente (1 ms)

  ‚óè 5. M√≥dulo de Metas (CRUD) ‚Ä∫ deve CRIAR uma nova meta com sucesso

    AxiosError: Request failed with status code 401

      28 |         };
      29 |
    > 30 |         const response = await axios.post(`${API_URL}/meta`, goalData, {
         |                          ^
      31 |             headers: { Authorization: `Bearer ${userToken}` }
      32 |         });
      33 |

      at settle (../node_modules/axios/lib/core/settle.js:19:12)
      at IncomingMessage.handleStreamEnd (../node_modules/axios/lib/adapters/http.js:793:11)
      at Axios.request (../node_modules/axios/lib/core/Axios.js:45:41)
      at Object.<anonymous> (metas.test.js:30:26)

  ‚óè 5. M√≥dulo de Metas (CRUD) ‚Ä∫ deve LISTAR as metas do usu√°rio logado

    expect(received).toBeDefined()

    Received: undefined

      41 |
      42 |     it('deve LISTAR as metas do usu√°rio logado', async () => {
    > 43 |         expect(createdGoalId).toBeDefined();
         |                               ^
      44 |
      45 |         const response = await axios.get(`${API_URL}/meta`, {
      46 |             headers: { Authorization: `Bearer ${userToken}` }

      at Object.toBeDefined (metas.test.js:43:31)

  ‚óè 5. M√≥dulo de Metas (CRUD) ‚Ä∫ deve ATUALIZAR uma meta existente

    expect(received).toBeDefined()

    Received: undefined

      54 |
      55 |     it('deve ATUALIZAR uma meta existente', async () => {
    > 56 |         expect(createdGoalId).toBeDefined();
         |                               ^
      57 |
      58 |         const updatedData = {
      59 |             title: 'Economizar para novo maquin√°rio (URGENTE)',

      at Object.toBeDefined (metas.test.js:56:31)

  ‚óè 5. M√≥dulo de Metas (CRUD) ‚Ä∫ deve EXCLUIR uma meta existente

    expect(received).toBeDefined()

    Received: undefined

      71 |
      72 |     it('deve EXCLUIR uma meta existente', async () => {
    > 73 |         expect(createdGoalId).toBeDefined();
         |                               ^
      74 |
      75 |         const response = await axios.delete(`${API_URL}/meta/${createdGoalId}`, {
      76 |             headers: { Authorization: `Bearer ${userToken}` }

      at Object.toBeDefined (metas.test.js:73:31)

 FAIL  Testes/clients.test.js
  7. M√≥dulo de Clientes/Fornecedores (TDD)
    √ó deve CRIAR um novo cliente com sucesso (23 ms)
    √ó deve LISTAR os clientes da empresa (4 ms)

  ‚óè 7. M√≥dulo de Clientes/Fornecedores (TDD) ‚Ä∫ deve CRIAR um novo cliente com sucesso

    AxiosError: Request failed with status code 404

      31 |     };
      32 |
    > 33 |     const response = await axios.post(`${API_URL}/clients`, newClient, {
         |                      ^
      34 |       headers: { Authorization: `Bearer ${companyA.token}` },
      35 |     });
      36 |

      at settle (../node_modules/axios/lib/core/settle.js:19:12)
      at IncomingMessage.handleStreamEnd (../node_modules/axios/lib/adapters/http.js:793:11)
      at Axios.request (../node_modules/axios/lib/core/Axios.js:45:41)
      at Object.<anonymous> (clients.test.js:33:22)

  ‚óè 7. M√≥dulo de Clientes/Fornecedores (TDD) ‚Ä∫ deve LISTAR os clientes da empresa

    AxiosError: Request failed with status code 404

      44 |   test('deve LISTAR os clientes da empresa', async () => {
      45 |     console.log('Executando teste para: RF-009 - LISTAR Clientes (Pendente)');
    > 46 |     const response = await axios.get(`${API_URL}/clients`, {
         |                      ^
      47 |       headers: { Authorization: `Bearer ${companyA.token}` },
      48 |     });
      49 |

      at settle (../node_modules/axios/lib/core/settle.js:19:12)
      at IncomingMessage.handleStreamEnd (../node_modules/axios/lib/adapters/http.js:793:11)
      at Axios.request (../node_modules/axios/lib/core/Axios.js:45:41)
      at Object.<anonymous> (clients.test.js:46:22)

 FAIL  Testes/reports.test.js
  8. M√≥dulo de Relat√≥rios (TDD)
    √ó deve EXPORTAR um relat√≥rio de transa√ß√µes em formato PDF (11 ms)

  ‚óè 8. M√≥dulo de Relat√≥rios (TDD) ‚Ä∫ deve EXPORTAR um relat√≥rio de transa√ß√µes em formato PDF

    AxiosError: Request failed with status code 404

      22 |
      23 |   test('deve EXPORTAR um relat√≥rio de transa√ß√µes em formato PDF', async () => {
    > 24 |     const response = await axios.get(`${API_URL}/reports/export/pdf`, {
         |                      ^
      25 |       headers: { Authorization: `Bearer ${companyA.token}` },
      26 |       responseType: 'arraybuffer', // Importante para receber arquivos bin√°rios
      27 |     });

      at settle (../node_modules/axios/lib/core/settle.js:19:12)
      at IncomingMessage.handleStreamEnd (../node_modules/axios/lib/adapters/http.js:793:11)
      at Axios.request (../node_modules/axios/lib/core/Axios.js:45:41)
      at Object.<anonymous> (reports.test.js:24:22)

 PASS  Testes/multi-tenant.test.js
  3. Teste de Isolamento de Dados em Larga Escala (Multi-Tenant)
    ‚àö deve criar uma transa√ß√£o para cada empresa (281 ms)
    ‚àö deve impedir que uma empresa acesse a transa√ß√£o de outra (359 ms)
    ‚àö deve garantir que cada empresa liste apenas suas pr√≥prias transa√ß√µes (165 ms)

 PASS  Testes/auth.legacy.test.js
  1. M√≥dulo de Autentica√ß√£o (Legado)
    ‚àö RF-001: deve ter cadastrado a Empresa A com sucesso no setup global (8 ms)
    ‚àö deve barrar o cadastro de um usu√°rio com e-mail j√° existente (42 ms)
    ‚àö deve falhar o login com senha incorreta (87 ms)
    ‚àö deve realizar o login com sucesso para a Empresa A (362 ms)
    ‚àö deve proteger rotas, barrando acesso sem token (7 ms)

 PASS  Testes/api.test.js
  1. M√≥dulo de Autentica√ß√£o (Legado)
    ‚àö RF-001: deve ter cadastrado a Empresa A com sucesso no setup global (3 ms)
    ‚àö deve barrar o cadastro de um usu√°rio com e-mail j√° existente (38 ms)
    ‚àö deve falhar o login com senha incorreta (109 ms)
    ‚àö deve realizar o login com sucesso para a Empresa A (121 ms)
    ‚àö deve proteger rotas, barrando acesso sem token (5 ms)

Test Suites: 8 failed, 3 passed, 11 total
Tests:       19 failed, 13 passed, 32 total
Snapshots:   0 total
Time:        20.283 s, estimated 22 s
Ran all test suites.
